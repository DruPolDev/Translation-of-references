<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="The !memusage extension displays summary statistics about physical memory use."/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>!memusage</title>

<meta name="MS-HAID" content="r27_exts_kernel_E_e5a27ddd-3d24-48ce-9076-7c72c6dd208d.xml"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="debugger._memusage"></a>!memusage</h1>
</div>
<p>The <b>!memusage</b> extension displays summary statistics about physical memory use.</p>
<p>Syntax</p>
<pre class="syntax"><b>!memusage </b>[<i>Flags</i>]</pre>
<h2><a id="ddk__memusage_dbg"></a><a id="DDK__MEMUSAGE_DBG"></a>Parameters</h2>
<p></p>
<dl>
<dt><a id="_______Flags______"></a><a id="_______flags______"></a><a id="_______FLAGS______"></a>       <i>Flags</i>      </dt>
<dd>
<p>  Can be any one of the following values. The default is 0x0.</p>
<p></p>
<dl>
<dt><a id="0x0"></a><a id="0X0"></a>0x0</dt>
<dd>
<p>Displays general summary information, along with a more detailed description of the pages in the PFN database. See the Remarks section for an example of this type of output. </p>
</dd>
<dt><a id="0x1"></a><a id="0X1"></a>0x1</dt>
<dd>
<p>Displays only summary information about the modified no-write pages in the PFN database..</p>
</dd>
<dt><a id="0x2"></a><a id="0X2"></a>0x2</dt>
<dd>
<p>Displays only detailed information about the modified no-write pages in the PFN database.</p>
</dd>
<dt><a id="0x8"></a><a id="0X8"></a>0x8</dt>
<dd>
<p>Displays only general summary information about memory use.</p>
</dd>
</dl>
</dd>
</dl>
<h3><a id="Environment"></a><a id="environment"></a><a id="ENVIRONMENT"></a>Environment</h3>
<table>
<tr>
<td>Modes</td>
<td>kernel mode only</td>
</tr>
</table>
<p> </p>
<h3><a id="DLL"></a><a id="dll"></a>DLL</h3>
<p>
          Kdexts.dll
         </p>
<h3><a id="Additional_Information"></a><a id="additional_information"></a><a id="ADDITIONAL_INFORMATION"></a>Additional Information</h3>
<p>Physical memory statistics are collected from the Memory Manager's page frame number (PFN) database table.</p>
<p>This command takes a long time to run, especially if the target computer is running in 64-bit mode, due to the greater amount of data to obtain. While it is loading the PFN database, a counter shows its progress. To speed up this loading, increase the COM port speed with the <a href="ctrl_a__toggle_baud_rate_.htm"><b>CTRL+A (Toggle Baud Rate)</b></a> key, or use the <a href="_cache__set_cache_size_.htm"><b>.cache (Set Cache Size)</b></a> command to increase the cache size (perhaps to around 10 MB).</p>
<p>The <b>!memusage</b> command can also be used while performing <a href="performing_local_kernel_debugging.htm">local kernel debugging</a>.</p>
<p>Here is an example of the output from this extension:</p>
<pre class="syntax" xml:space="preserve"><code>kd&gt; !memusage
 loading PFN database
loading (98% complete)

Compiling memory usage data (100% Complete).
             Zeroed:     49 (   196 kb)
               Free:      5 (    20 kb)
            Standby:   5489 ( 21956 kb)
           Modified:    714 (  2856 kb)
    ModifiedNoWrite:      1 (     4 kb)
       Active/Valid:  10119 ( 40476 kb)
         Transition:      6 (    24 kb)
            Unknown:      0 (     0 kb)
              TOTAL:  16383 ( 65532 kb)

  Building kernel map
  Finished building kernel map
Scanning PFN database - (99% complete) 

  Usage Summary (in Kb):


Control Valid Standby Dirty Shared Locked PageTables  name

8251a258    12    108     0     0     0     0  mapped_file( cscui.dll )
827ab1b8     8   1708     0     0     0     0  mapped_file( $Mft )
8263c408   908     48     0     0     0     0  mapped_file( win32k.sys )
8252dda8     0    324     0     0     0     0  mapped_file( ShellIconCache )
8272f638   128    112     0   116     0     0  mapped_file( advapi32.dll )
......
82755958     0      4     0     0     0     0  mapped_file( $Directory )
8250b518     0      4     0     0     0     0    No Name for File
8254d8d8     0      4     0     0     0     0  mapped_file( $Directory )
82537be8     0      4     0     0     0     0  mapped_file( Windows Explorer.lnk )

--------  1348      0     0 ----- -----   904  process ( System )
--------   492      0     0 ----- -----    72  process ( winmine.exe )
--------  3364   1384  1396 ----- -----   188  process ( explorer.exe )
--------   972      0     0 ----- -----    88  process ( services.exe )
--------   496   1456   384 ----- -----   164  process ( winmgmt.exe )
--------  1144      0     0 ----- -----   120  process ( svchost.exe )
--------   944      0     0 ----- -----   156  process ( winlogon.exe )
--------   412      0     0 ----- -----    64  process ( csrss.exe )
......
--------    12      0     0 ----- -----     8  process ( wmiadap.exe )

--------   316      0     0 ----- -----     0  pagefile section (346e)
--------  4096      0     0 ----- -----     0  pagefile section (9ad)

--------   884    280    36 -----     0 -----  driver ( ntoskrnl.exe )
--------    88      8     0 -----     0 -----  driver ( hal.dll )
--------     8      0     0 -----     0 -----  driver ( kdcom.dll )
--------    12      0     0 -----     0 -----  driver ( BOOTVID.dll )
......
--------     8      0     0 -----     0 -----  driver ( ndisuio.sys )
--------    16      0     0 -----     0 -----  driver ( dump_scsiport.sys )
--------    56      0     0 -----     0 -----  driver ( dump_aic78xx.sys )
--------  2756   1060   876 -----     0 -----  driver ( Paged Pool )
--------  1936    128   148 -----     0 -----  driver ( Kernel Stacks )
--------     0      0     0 -----     0 -----  driver ( NonPaged Pool )</code></pre>
<p>The first column displays the address of the control area structure that describes each mapped structure. Use the <a href="_ca.htm"><b>!ca</b></a> extension command to display these control areas.</p>
<h2>Remarks</h2>
<p>You can use the <a href="_vm.htm"><b>!vm</b></a> extension command to analyze virtual memory use. This extension is typically more useful than <b>!memusage</b>. For more information about memory management, see <i>Microsoft Windows Internals</i>, by Mark Russinovich and David Solomon. (This book may not be available in some languages 

and countries.)
</p>
<p>The <a href="_pfn.htm"><b>!pfn</b></a> extension command can be used to display a particular page frame entry in the PFN database.</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [debugger\debugger]:%20!memusage%20 RELEASE:%20(3/16/2017)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
