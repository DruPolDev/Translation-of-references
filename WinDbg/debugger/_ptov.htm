<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="The !ptov extension displays the entire physical-to-virtual map for a given process."/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>!ptov</title>

<meta name="MS-HAID" content="r28_exts_kernel_N_27c12d34-9386-442e-805c-4a62ad3002d0.xml"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="debugger._ptov"></a>!ptov</h1>
</div>
<p>The <b>!ptov</b> extension displays the entire physical-to-virtual map for a given process.</p>
<pre class="syntax"><b>!ptov </b><i>DirBase</i></pre>
<h2><a id="ddk__ptov_dbg"></a><a id="DDK__PTOV_DBG"></a>Parameters</h2>
<p></p>
<dl>
<dt><a id="_______DirBase______"></a><a id="_______dirbase______"></a><a id="_______DIRBASE______"></a>       <i>DirBase</i>      </dt>
<dd>
<p>Specifies the directory base for the process. To determine the directory base, use the <a href="_process.htm"><b>!process</b></a> command, and look at the value displayed for DirBase.</p>
</dd>
</dl>
<h3><a id="DLL"></a><a id="dll"></a>DLL</h3>
<table>
<tr>
<td>
<p><b>Windows 2000</b></p>
</td>
<td>
<p>
          Kdextx86.dll
         </p>
</td>
</tr>
<tr>
<td>
<p><b>Windows XP and later
         </b></p>
</td>
<td>
<p>
          Kdexts.dll
         </p>
</td>
</tr>
</table>
<p> </p>
<h2>Remarks</h2>
<p>Here is an example. First, use  <a href="_process__set_process_context_.htm"><b>.process</b></a> and <a href="_process.htm"><b>!process</b></a> to determine the directory base of the current process:</p>
<pre class="syntax" xml:space="preserve"><code>1: kd&gt; .process
Implicit process is now 852b4040
1: kd&gt; !process 852b4040 1
PROCESS 852b4040  SessionId: none  Cid: 0004    Peb: 00000000  ParentCid: 0000
    DirBase: 00185000  ObjectTable: 83203000  HandleCount: 663.
    Image: System
    ...</code></pre>
<p>In this case, the directory base is 0x00185000. Pass this address to <b>!ptov</b>:</p>
<pre class="syntax" xml:space="preserve"><code>1: kd&gt; !ptov 185000
X86PtoV: pagedir 185000, PAE enabled.
15e11000 10000
549e6000 20000
...
60a000 210000
40b000 211000
...
54ad3000 25f000
548d3000 260000
...
d71000 77510000
...</code></pre>
<p>The numbers in the left column are the physical addresses of each memory page that has a mapping for this process. The numbers in the right column are the virtual addresses to which they are mapped.</p>
<p>The total display is very long.</p>
<p>Here is a 64-bit example.</p>
<pre class="syntax" xml:space="preserve"><code>3: kd&gt; .process
Implicit process is now fffffa80`0361eb30
3: kd&gt; !process fffffa80`0361eb30 1
PROCESS fffffa800361eb30
    SessionId: none  Cid: 0004    Peb: 00000000  ParentCid: 0000
    DirBase: 00187000  ObjectTable: fffff8a000002870  HandleCount: 919.
    Image: System
    ...
3: kd&gt; !ptov 187000
Amd64PtoV: pagedir 187000
00000001`034fb000 1d0000
a757c000 1d1000
00000001`0103d000 1d2000
c041e000 1d3000
...
2ed6f000 fffff680`00001000
00000001`13939000 fffff680`00003000
ceefb000 fffff680`00008000
...</code></pre>
<p>The directory base is the physical address of the first table that is used in virtual address translation. This table has different names depending on the bitness of the target operating system and whether Physical Address Extension (PAE) is enabled for the target operating system. </p>
<p>For 64-bit Windows, the directory base is the physical address of the Page Map Level 4 (PML4) table. For 32-bit Windows with PAE enabled, the directory base is the physical address of the Page Directory Pointers (PDP) table. For 32-bit Windows with PAE disabled, the directory bas is the physical address of the Page Directory (PD) table.</p>
<p>For related topics, see <a href="_vtop.htm"><b>!vtop</b></a> and <a href="converting_virtual_addresses_to_physical_addresses.htm">Converting Virtual Addresses to Physical Addresses</a>. For information about virtual address translation, see <i>Microsoft Windows Internals</i>, by Mark Russinovich and David Solomon. (These resources may not be available in some languages 

and countries.)</p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [debugger\debugger]:%20!ptov%20 RELEASE:%20(3/16/2017)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
