<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Using AgeStore"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Using AgeStore</title>

<meta name="MS-HAID" content="SymChk_7614e89a-f669-4c32-af18-931d396fc8eb.xml"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="debugger.using_agestore"></a>Using AgeStore</h1>
</div>
<p>AgeStore is a tool that deletes files in a directory or directory tree, based on their last access dates.  Its primary use is for removing old files from the downstream store used by a symbol server or a source server, in order to conserve disk space. It can also be used as a general file deletion tool.</p>
<p>AgeStore can delete all files in a single directory (the <i>target directory</i>), or in all the directories within a tree (the <i>target tree</i>). The -s option indicates that an entire tree is to be targeted.</p>
<p>There are three ways to specify which files within the target directory or target tree are to be deleted.  The agestore -date=Month-Day-Year command deletes all files that were last accessed prior to the specified date.  The agestore -days=NumberOfDays command deletes all files that were last accessed more than the specified number of days ago.  The agestore -size=SizeRemaining command deletes all files in the target directory or target tree, beginning with the least-recently-accessed files, until the total size of the remaining files is less than or equal to <i>SizeRemaining</i>.</p>
<p>For example, the following command deletes all files in C:\MyDir that were last accessed prior to January 7, 2008:</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>agestore c:\mydir -date=01-07-2008</pre>
</td>
</tr>
</table></span></div>
<p>The following command deletes all files in the directory tree subordinate to C:\symbols\downstreamstore that were last accessed over thirty days ago:</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>agestore c:\symbols\downstreamstore -days=30 -s</pre>
</td>
</tr>
</table></span></div>
<p>The following command deletes files in the directory tree subordinate to C:\symbols\downstreamstore, beginning with those accessed longest ago, until the total size of all files in this tree is less than or equal to 50,000 bytes:</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>agestore c:\symbols\downstreamstore -size=50000 -s</pre>
</td>
</tr>
</table></span></div>
<p>The -l option causes AgeStore to delete no files, but merely to list all the files that <u>would</u> be deleted without this option.  Before you use any AgeStore command you should run the intended command with the -l option added, to verify that it will delete exactly those files you intend it to delete.</p>
<p>For the complete command line syntax, see <a href="agestore_command_line_options.htm"><b>AgeStore Command-Line Options</b></a>.</p>
<h3><a id="running_agestore_on_windows_vista_and_later"></a><a id="RUNNING_AGESTORE_ON_WINDOWS_VISTA_AND_LATER"></a>Running AgeStore on Windows Vista and Later</h3>
<p>Because AgeStore deletes files based on the last time that they were accessed, it can run successfully only if your your file system stores Last Access Time (LAT) data.  In the NTFS file system, LAT data storage can be either enabled or disabled.  If it is disabled, AgeStore will not run, but will display the following error message instead:</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>Last-Access-Time support is disabled on this computer.
Please read the documentation for more details.</pre>
</td>
</tr>
</table></span></div>
<p>In Windows 2000, Windows XP, and Windows Server 2003, LAT data storage is enabled by default.  In Windows Vista and later versions of Windows, LAT data storage is disabled by default, and therefore AgeStore will not run unless you first enable this data.  </p>
<p>In Windows Vista and later versions of Windows, you can use the FSUtil (Fsutil.exe) tool to enable the gathering of LAT data.  From a Command Prompt window, issue the following command: </p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>fsutil behavior set disablelastaccess 0 </pre>
</td>
</tr>
</table></span></div>
<p>To disable the gathering of LAT data, using the following command: </p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>fsutil behavior set disablelastaccess 1 </pre>
</td>
</tr>
</table></span></div>
<p>These changes take effect after the next restart of Windows. </p>
<p>The FAT32 file system always stores LAT information (although only the date, and not the time, are stored).  Therefore, AgeStore works with FAT32 file systems.  However, since AgeStore will not run when the NTFS LAT is disabled, you must enable NTFS LAT even if your file system is FAT32.  </p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [debugger\debugger]:%20Using AgeStore%20 RELEASE:%20(3/16/2017)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
