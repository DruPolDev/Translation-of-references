<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:mssdk="winsdk" xmlns:script="urn:script" xmlns:build="urn:build" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="Description" content="Interpreting Bug Check 0xCB"/>
<meta name="MSHAttr" content="PreferredSiteName:MSDN"/>
<meta name="MSHAttr" content="PreferredLib:/library/windows/hardware"/>
<title>Interpreting Bug Check 0xCB</title>

<meta name="MS-HAID" content="t11~b_ks_db6a9d3d-9bf5-438e-83a0-01d12ab85743.xml"/>


<link rel="STYLESHEET" type="text/css" HREF="../common/backsdk4.css"/>


</head>
<body>

<div id="mainSection">
<div class="clsServerSDKContent">
<h1><a id="debugger.interpreting_bug_check_0xcb"></a>Interpreting Bug Check 0xCB</h1>
</div>
<p>The most common bug check code associated with debugging a video stream stall is Bug Check 0xCB (DRIVER_LEFT_LOCKED_PAGES_IN_PROCESS).  For a detailed list of its parameters, see <a href="bug_check_0xcb__driver_left_locked_pages_in_process.htm"><b>Bug Check 0xCB</b></a>.  </p>
<p>The message displayed when the bug check occurs will point to Ks.sys as the cause.</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>Use !analyze -v to get detailed debugging information.
BugCheck CB, {f90c6ae0, f9949215, 81861788, 26}
Probably caused by : ks.sys ( ks!KsProbeStreamIrp+333 )</pre>
</td>
</tr>
</table></span></div>
<p>As suggested, use <a href="_analyze.htm"><b>!analyze -v</b></a> to get more detailed information.</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>kd&gt; !analyze -v
DRIVER_LEFT_LOCKED_PAGES_IN_PROCESS (cb)
Caused by a driver not cleaning up completely after an I/O.
When possible, the guilty driver's name (Unicode string) is printed on
the bugcheck screen and saved in KiBugCheckDriver.
Arguments:
Arg3: 81861788, A pointer to the MDL containing the locked pages.</pre>
</td>
</tr>
</table></span></div>
<p>Now, use the <a href="_search.htm"><b>!search</b></a> extension to find the virtual addresses that are associated with the MDL pointer.</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>kd&gt; !search 81861788
Searching PFNs in range 00000001 - 0000FF76 for [FFFFFFFF81861788 - FFFFFFFF81861788]

Pfn      Offset   Hit      Va       Pte
- - - - - - - - - - - - - - - - - - - - - - - - - - -
000008A7 00000B0C 81861788 808A7B0C C020229C
00000A04 00000224 16000001 80A04224 C0202810
...
00001732 000009B4 81861788 817329B4 C0205CC8</pre>
</td>
</tr>
</table></span></div>
<p>For each virtual address (VA) found, look for an IRP signature. Do this by using the <a href="d__da__db__dc__dd__dd__df__dp__dq__du__dw__dw__dyb__dyd__display_memor.htm"><b>dd</b></a> command with the VA minus one DWORD.</p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>kd&gt; dd 808A7B0C-4 l4
808a7b08  f9949215 81861788 00000026 00000000
kd&gt; $ Not an Irp
kd&gt; dd 80A04224-4 l4
80a04220  00000000 00000000 00000000 00000000
kd&gt; $ Not an Irp
kd&gt; dd 817329B4-4 l4
817329b0  01900006 81861788 00000070 ffa59220
kd&gt; $ Matches signature</pre>
</td>
</tr>
</table></span></div>
<p>After a VA with an IRP signature has been found, use the <a href="_irp.htm"><b>!irp</b></a> extension to find out what driver is pending on this IRP.  </p>
<div class="code"><span codelanguage=""><table>
<tr>
<th></th>
</tr>
<tr>
<td>
<pre>kd&gt; !irp 817329b0 7
Irp is active with 2 stacks 2 is current (= 0x81732a44)
 Mdl = 81861788 System buffer = ffa59220 Thread 00000000:  Irp stack trace.
&gt;[  e, 0]   1  1 81a883c8 81ae6158 00000000-00000000    pending
 \Driver\TESTCAP
                        Args: 00000070 00000000 002f4017 00000000</pre>
</td>
</tr>
</table></span></div>
<p>In this case, \Driver\TESTCAP is the likely cause of the bug check.  </p>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [debugger\debugger]:%20Interpreting Bug Check 0xCB%20 RELEASE:%20(3/16/2017)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
<p style="text-align:left;font-family:Arial,sanserif;font-size:100%;color:black">
&#x00a9;&#x00a0;2016 Microsoft. All rights reserved.</p>

</body>
</html>
