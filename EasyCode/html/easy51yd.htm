<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=Windows-1252">
  <title>GetRegistryValue method</title>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<p><b><font color="#800080" face="Arial" size="6">GetRegistryValue
<font color="#004080">method</font></font></b></p>
<hr>
<p><font face="Arial" size="2"><b>Prototype</b></font></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial"><font size="2"><b><font color="#800080">GetRegistryValue</font></b>
  <b><font color="#0000ff">Proto</font></b>
  <b>hKey<font color="#ff00ff">:</font><font color="#000080">HKEY</font><font
 color="#ff00ff">,</font></b>
  <b>lpszSubKey<font color="#ff00ff">:</font><font color="#000080">LPSTR</font><font
 color="#ff00ff">,</font></b>
  <b>lpszValueName<font color="#ff00ff">:</font><font color="#000080">LPSTR</font><font
 color="#ff00ff">,</font></b>
  <b>lpszValue<font color="#ff00ff">:</font><font color="#000080">LPSTR</font></b></font></font></p>
</blockquote>
<p><b><font face="Arial" size="2">Syntax</font></b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial"><font size="2"><b><font color="#0000ff">Invoke</font></b>
  <b><font color="#800080">GetRegistryValue</font><font color="#ff00ff">,</font></b>
  <b>hKey<font color="#ff00ff">,</font></b>
  <b>lpszSubKey<font color="#ff00ff">,</font></b>
  <b>lpszValueName<font color="#ff00ff">,</font></b>
  <b>lpszValue</b></font></font></p>
</blockquote>
<p><b><font face="Arial" size="2">Function</font></b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial" size="2">Retrieves the data of
the specified named value from the specified registry
subkey.</font></p>
</blockquote>
<p><b><font face="Arial" size="2">Parameters</font></b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><b><font face="Arial" size="2">hKey</font></b></p>
  <blockquote style="margin-right: 0px;" dir="ltr">
    <p><font face="Arial" size="2">Handle to one of the
following predefined keys:</font></p>
    <blockquote style="margin-right: 0px;" dir="ltr">
      <p><b><font face="Arial" size="2"><font color="#800080">ecClassesRoot</font><br>
      </font></b><b><font face="Arial" size="2"><font color="#800080">ecCurrentUser</font><br>
      </font></b><b><font face="Arial" size="2"><font color="#800080">ecLocalMachine</font><br>
      </font></b><b><font face="Arial" size="2"><font color="#800080">ecUsers</font><br>
      </font></b><b><font face="Arial" size="2"><font color="#800080">ecPerformanceData</font><br>
      </font></b><b><font face="Arial" size="2"><font color="#800080">ecCurrentConfig</font><br>
      </font></b><b><font face="Arial" size="2"><font color="#800080">ecDynData</font></font></b></p>
    </blockquote>
  </blockquote>
  <p><font face="Arial" size="2"><b><font face="Arial" size="2">lpszSubKey</font></b></font></p>
  <blockquote style="margin-right: 0px;" dir="ltr">
    <p><font face="Arial" size="2"><font face="Arial" size="2">Pointer
to the effective
address of a null-terminated string that names the
path of the subkey containing the named value whose value is to be
retrieved.</font></font></p>
  </blockquote>
  <p><font face="Arial" size="2"><b><font face="Arial" size="2">lpszValueName</font></b></font></p>
  <blockquote style="margin-right: 0px;" dir="ltr">
    <p><font face="Arial" size="2"><font face="Arial" size="2">Pointer
to the effective
address of a null-terminated string that names the
named value whose value is to be retrieved.</font></font></p>
  </blockquote>
  <p><font face="Arial" size="2"><b><font face="Arial" size="2">lpszValue</font></b></font></p>
  <blockquote style="margin-right: 0px;" dir="ltr">
    <p><font face="Arial" size="2"><font face="Arial" size="2">Pointer
to the effective
address of a null-terminated string to receive the
retrieved value.</font></font></p>
  </blockquote>
</blockquote>
<p><font face="Arial" size="2"><b><font face="Arial" size="2">Return
value</font></b></font></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial" size="2"><font face="Arial"><font size="2"><b><font
 color="#808000">Eax/Rax</font></b>
returns <b><font color="#000080">TRUE</font></b>
if successful, or <b><font color="#000080">FALSE</font></b>
if
not.</font></font></font></p>
</blockquote>
<p><font face="Arial" size="2"><font face="Arial" size="2"><br>
<b>REMARKS</b>:
The <b>lpszValue</b>
parameter points to a null-terminated
string to receive the retrieved data. You can fill this parameter with
the desired <b>default</b>
value before
calling the method, as it will return the same value if the specified
named value is not
found.</font></font></p>
<p><font face="Arial" size="2"><b>REMARKS</b>:
The <font color="#800080"><b>GetRegistryValue</b></font>
method
expects <b>lpszSubKey</b>
and <b>lpszValueName</b>
to be Unicode strings, and fills <b>lpszValue</b>
with a Unicode
value if the application is running as Unicode. Otherwise, it expects <b>lpszSubKey</b>
and <b>lpszValueName</b>
to
be ANSI strings, and fills <b>lpszValue</b>
with an ANSI value (see the <a href="AppUnicode.htm"><font
 color="#800080">IsAppUnicode</font></a>
method). You can call <font color="#800080"><b>GetRegistryValueA</b></font>
to get ANSI values in Unicode applications, or <font color="#800080"><b>GetRegistryValueW</b></font>
to get
Unicode values in ANSI applications.</font></p>
<p><font face="Arial" size="2"><b>IMPORTANT</b>:
The string pointed by <b>lpszValue</b>
must be able to
allocate up to <b><font color="#000080">MAX_PATH</font></b>
characters.<br>
<br>
</font></p>
</body>
</html>
