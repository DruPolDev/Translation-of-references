<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=Windows-1252">
  <title>WriteTextLine method</title>
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<p><b><font color="#800080" face="Arial" size="6">WriteTextLine
<font color="#004080">method</font></font></b></p>
<hr>
<p><font face="Arial" size="2"><b>Prototype</b></font></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial"><font size="2"><b><font color="#800080">WriteTextLine</font></b>
  <b><font color="#0000ff">Proto</font></b>
  <b>hHandle<font color="#ff00ff">:</font><font color="#000080">HANDLE</font><font
 color="#ff00ff">,</font>
lpszBuffer<font color="#ff00ff">:</font><font color="#000080">LPSTR</font></b></font></font></p>
</blockquote>
<p><b><font face="Arial" size="2">Syntax</font></b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial"><font size="2"><b><font color="#0000ff">Invoke</font></b>
  <b><font color="#800080">WriteTextLine</font><font color="#ff00ff">,</font>
hHandle<font color="#ff00ff">,</font>
lpszBuffer</b></font></font></p>
</blockquote>
<p><b><font face="Arial" size="2">Function</font></b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial" size="2">Writes a line of text to
an open file.</font></p>
</blockquote>
<p><b><font face="Arial" size="2">Parameters</font></b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><b><font face="Arial" size="2">hHandle</font></b></p>
  <blockquote style="margin-right: 0px;" dir="ltr">
    <p><font face="Arial" size="2">Open handle to a text
file (returned by </font><a href="easy0vvp.htm"><font face="Arial"
 size="2"><b>OpenTextFile</b></font></a><font face="Arial" size="2">).</font></p>
  </blockquote>
  <p><b><font face="Arial" size="2">lpszFileName</font></b></p>
  <blockquote style="margin-right: 0px;" dir="ltr">
    <p><font face="Arial" size="2">Pointer to the effective
address of a buffer containing the text line to
write.</font></p>
  </blockquote>
</blockquote>
<p><b><font face="Arial" size="2">Return value</font>
</b></p>
<blockquote style="margin-right: 0px;" dir="ltr">
  <p><font face="Arial"><font size="2"><b><font color="#808000">Eax/Rax</font></b>
returns <b><font color="#000080">TRUE</font></b>
if successful, or <b><font color="#000080">FALSE</font></b>
if
not.</font></font></p>
</blockquote>
<p><font face="Arial"><font size="2"><br>
<b>REMARKS</b>:
This method checks whether the two last characters
of the buffer are &lt;<b>CR</b>&gt;
and &lt;<b>LF</b>&gt;.
If not, they are added to file (but not to buffer).
On the other hand, if the last character is a &lt;<b>CR</b>&gt;
but not followed by &lt;<b>LF</b>&gt;,
the
&lt;<b>LF</b>&gt;
character is added to file.</font></font></p>
<p><font face="Arial" size="2"><br>
<b>REMARKS</b>:
The <font color="#800080"><b>WriteTextLine</b></font>
method expects <b>lpszBuffer</b>
to be a Unicode string if the application is running as Unicode,
or an ANSI string if not (see the <a href="AppUnicode.htm"><font
 color="#800080">IsAppUnicode</font></a>
method). You can call <font color="#800080"><b>WriteTextLineA</b></font>
to write ANSI text lines in Unicode
applications, or <font color="#800080"><b>WriteTextLineW</b></font>
to write Unicode text lines in ANSI
applications.<br><br>When writing Unicode files, remember that the two first
bytes (a word) are not a Unicode
character, but a code identifying the type of Unicode file (little
endian or big endian). Set these two
first bytes to <b>0FFFEH</b>
for little endian, or <b>0FEFFH</b>
for big endian. Take into account that the <a href="easy3oit.htm"><font
color="#800080"><b>ReadTextLine</b></font></a>
method reads Unicode files in little endian format.</font></p>
</body>
</html>
